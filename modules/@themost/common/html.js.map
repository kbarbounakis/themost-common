{"version":3,"sources":["html.es6.js"],"names":[],"mappings":"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","file":"html.js","sourcesContent":["/**\n * @license\n * MOST Web Framework 2.0 Codename Blueshift\n * Copyright (c) 2017, THEMOST LP All rights reserved\n *\n * Use of this source code is governed by an BSD-3-Clause license that can be\n * found in the LICENSE file at https://themost.io/license\n */\nimport 'source-map-support/register';\nimport _ from 'lodash';\n\n/**\n * @private\n */\nconst HTML_END_CHAR = '>';\nconst HTML_FULL_END_STRING = ' />';\nconst HTML_SPACE_CHAR = ' ';\nconst HTML_ATTR_STRING = '%0=\"%1\"';\nconst HTML_START_TAG_STRING = '<%0';\nconst HTML_END_TAG_STRING = '</%0>';\n\n/**\n * @classdesc HtmlWriter class represents a helper class for rendering HTML content.\n * @class\n */\nexport class HtmlWriter {\n    constructor() {\n        /**\n         * @private\n         * @type {Array}\n         */\n        this.bufferedAttributes=[];\n        /**\n         * @private\n         * @type {Array}\n         */\n        this.bufferedTags = [];\n        /**\n         * @private\n         * @type {String}\n         */\n        this.buffer = '';\n        /**\n         * @private\n         * @type {Integer}\n         */\n        this.indent = true;\n    }\n\n    /**\n     * Writes an attribute to an array of attributes that is going to be used in writeBeginTag function\n     * @param {String} name - The name of the HTML attribute\n     * @param {String} value - The value of the HTML attribute\n     * @returns {HtmlWriter}\n     */\n    writeAttribute(name, value) {\n        this.bufferedAttributes.push({name:name, value:value});\n        return this;\n    }\n\n    /**\n     * Writes an array of attributes to the output buffer. This attributes are going to be rendered after writeBeginTag or WriteFullBeginTag function call.\n     * @param {Array|Object} obj - An array of attributes or an object that represents an array of attributes\n     * @returns {HtmlWriter}\n     */\n    writeAttributes(obj) {\n        if (_.isNil(obj))\n            return this;\n        if (_.isArray(obj)) {\n            for (let i = 0; i < obj.length; i++) {\n                this.bufferedAttributes.push( { name:obj[i].name, value:obj[i].value } );\n            }\n        }\n        else {\n            for (const prop in obj)\n            {\n                if (obj.hasOwnProperty(prop)) {\n                    if (obj[prop]!==null) {\n                        this.bufferedAttributes.push( { name:prop, value:obj[prop] } );\n                    }\n                }\n            }\n        }\n        return this;\n    }\n\n    /**\n     * @param {String} tag\n     * @returns {HtmlWriter}\n     */\n    writeBeginTag(tag) {\n        //write <TAG\n        if (this.indent)\n        {\n            //this.buffer += '\\n';\n            this.buffer +=_.repeat('\\t',this.bufferedTags.length);\n        }\n        this.buffer += HTML_START_TAG_STRING.replace(/%0/, tag);\n        this.bufferedTags.push(tag);\n        if (this.bufferedAttributes.length>0)\n        {\n            let s = '';\n            _.forEach(this.bufferedAttributes, function(attr) {\n                //write attribute='value'\n                s += HTML_SPACE_CHAR;\n                s += HTML_ATTR_STRING.replace(/%0/,attr.name).replace(/%1/, _.escape(attr.value));\n            });\n            this.buffer += s;\n        }\n        this.bufferedAttributes.splice(0,this.bufferedAttributes.length);\n        this.buffer += HTML_END_CHAR;\n        return this;\n    }\n\n    /**\n     * Writes a full begin HTML tag (e.g <div/>).\n     * @param {String} tag\n     * @returns {HtmlWriter}\n     */\n    writeFullBeginTag(tag) {\n        //write <TAG\n        if (this.indent)\n        {\n            this.buffer += '\\n';\n            this.buffer +=_.repeat('\\t',this.bufferedTags.length);\n        }\n        this.buffer += HTML_START_TAG_STRING.replace(/%0/, tag);\n        if (this.bufferedAttributes.length>0)\n        {\n            let s = '';\n            _.forEach(this.bufferedAttributes, function(attr) {\n                //write attribute='value'\n                s += HTML_SPACE_CHAR;\n                s += HTML_ATTR_STRING.replace(/%0/,attr.name).replace(/%1/, _.escape(attr.value));\n            });\n            this.buffer += s;\n        }\n        this.bufferedAttributes.splice(0,this.bufferedAttributes.length);\n        this.buffer += HTML_FULL_END_STRING;\n        return this;\n    }\n\n    /**\n     * Writes an end HTML tag (e.g </div>) based on the current buffered tags.\n     * @returns {HtmlWriter}\n     */\n    writeEndTag() {\n        const tagsLength = this.bufferedTags ? this.bufferedTags.length : 0;\n        if (tagsLength===0)\n            return this;\n        if (this.indent)\n        {\n            this.buffer += '\\n';\n            this.buffer +=_.repeat('\\t',tagsLength-1);\n        }\n        this.buffer += HTML_END_TAG_STRING.replace(/%0/,this.bufferedTags[tagsLength-1]);\n        this.bufferedTags.splice(tagsLength-1,1);\n        return this;\n    }\n\n    /**\n     *\n     * @param {String} s\n     * @returns {HtmlWriter}\n     */\n    writeText(s) {\n        if (!s)\n            return this;\n        if (this.indent)\n        {\n            this.buffer += '\\n';\n            this.buffer +=_.repeat('\\t',this.bufferedTags.length);\n        }\n        this.buffer += _.escape(s);\n        return this;\n    }\n\n    /**\n     *\n     * @param {String} s\n     * @returns {HtmlWriter}\n     */\n    write(s) {\n        this.buffer += s;\n        return this;\n    }\n\n    /**\n     * @returns {String}\n     */\n    toString() {\n        return this.buffer;\n    }\n\n    /**\n     * @param {function} fn\n     */\n    writeTo(fn) {\n        if (typeof fn === 'function') {\n            //call function\n            fn(this.buffer);\n            //and clear buffer\n            this.buffer='';\n            //and clear buffered tags\n            this.bufferedTags.splice(0,this.bufferedTags.length);\n        }\n    }\n}\n"]}